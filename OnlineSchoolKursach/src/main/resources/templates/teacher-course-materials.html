<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title th:text="${'Материалы курса: ' + course.title}">Материалы курса</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/css/custom-theme.css}">
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-info">
		<div class="container">
			<a class="navbar-brand text-white" href="/">SupSchool</a>
			<div class="navbar-nav ms-auto">
				<a class="nav-link text-white" th:href="@{'/teacher/course/' + ${course.courseId}}">К курсу</a>
				<a class="nav-link text-white" href="/teacher">Мои курсы</a>
				<a class="nav-link text-white" href="/logout">Выйти</a>
			</div>
		</div>
	</nav>

	<div class="container py-4">
		<h2 class="mb-4">
			<i class="fas fa-folder-open me-2"></i>
			Материалы курса: <span th:text="${course.title}">Название курса</span>
		</h2>

		<div class="row">
			<div class="col-12">
				<div class="card mb-4">
					<div class="card-header">
						<h5 class="mb-0">Материалы уроков</h5>
					</div>
					<div class="card-body">
						<div th:if="${#lists.isEmpty(lessons)}" class="text-muted">Уроки отсутствуют</div>
						<div th:unless="${#lists.isEmpty(lessons)}">
							<table class="table align-middle">
								<thead>
								<tr>
									<th style="width: 40%">Урок</th>
									<th style="width: 40%">Файл</th>
									<th style="width: 20%">Действие</th>
								</tr>
								</thead>
								<tbody>
								<tr th:each="lesson : ${lessons}" th:if="${lesson.attachedFile != null && !#strings.isEmpty(lesson.attachedFile)}">
									<td>
										<div class="fw-semibold" th:text="${lesson.title}">Название урока</div>
									</td>
									<td>
										<div class="text-truncate" style="max-width: 420px;" th:text="${lesson.attachedFile}">path/in/minio.pdf</div>
									</td>
									<td>
										<a class="btn btn-outline-primary btn-sm"
										   th:attr="href=${'/v1/api/files/download?path=' + #strings.replace(#strings.replace(#strings.replace(lesson.attachedFile, '/', '%2F'), ' ', '%20'), '+', '%2B')}}"
										   target="_blank">
											<i class="fas fa-download"></i> Скачать
										</a>
									</td>
								</tr>
								<tr th:if="${#lists.isEmpty(#lists.select(lessons, l -> l.attachedFile != null && !#strings.isEmpty(l.attachedFile)))}">
									<td colspan="3" class="text-muted">Материалы к урокам не прикреплены</td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<div class="card">
					<div class="card-header">
						<h5 class="mb-0">Материалы заданий</h5>
					</div>
					<div class="card-body">
						<div th:if="${#lists.isEmpty(tasks)}" class="text-muted">Задания отсутствуют</div>
						<div th:unless="${#lists.isEmpty(tasks)}">
							<table class="table align-middle">
								<thead>
								<tr>
									<th style="width: 30%">Урок</th>
									<th style="width: 30%">Задание</th>
									<th style="width: 20%">Файл</th>
									<th style="width: 20%">Действие</th>
								</tr>
								</thead>
								<tbody>
								<tr th:each="task : ${tasks}" th:if="${task.attachedFile != null && !#strings.isEmpty(task.attachedFile)}">
									<td class="text-truncate" style="max-width: 260px;" th:text="${task.lesson != null ? task.lesson.title : '—'}">Урок</td>
									<td class="text-truncate" style="max-width: 260px;" th:text="${task.title}">Задание</td>
									<td class="text-truncate" style="max-width: 260px;" th:text="${task.attachedFile}">path/in/minio.pdf</td>
									<td>
										<a class="btn btn-outline-primary btn-sm"
										   th:attr="href=${'/v1/api/files/download?path=' + #strings.replace(#strings.replace(#strings.replace(task.attachedFile, '/', '%2F'), ' ', '%20'), '+', '%2B')}}"
										   target="_blank">
											<i class="fas fa-download"></i> Скачать
										</a>
									</td>
								</tr>
								<tr th:if="${#lists.isEmpty(#lists.select(tasks, t -> t.attachedFile != null && !#strings.isEmpty(t.attachedFile)))}">
									<td colspan="4" class="text-muted">Материалы к заданиям не прикреплены</td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
</body>
</html>

